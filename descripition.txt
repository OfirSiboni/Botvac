Botvac - description
botvac הוא פרויקט botnet, המאפשר הרצת נוזקה מלקוחות רבים על מטרה יחידה, ונוסף על כך, קצירה (harvesting) של נתוני דפדפן של הלקוח, שתאפשר גישה מלאה לחשבונותיו השמורים (כולל כל הסיסמאות השמורות).
צד השרת
השרת, למעשה, הוא vm מסוג debian linux היושב בשרת Azure עם כתובת IP ציבורית שאינה משתנה. את השרת הקמנו בעזרת תוכנית ה-Free tier של Azure, והיא מאפשרת לנו גישה מרוכזת ונוחה לשרת.

השרת המאחסן בתוכו תוכנית Flask שרצה באופן תמידי, ואחראית לניהול המשימות של הלקוחות השונים. הקפדנו שהתקשורת בין השרת ללקוח תהיה מוצפנת באמצעות RSA (מפתחות קבועים המוגדרים באמצעות קבצים היושבים בצד השרת והלקוח).
בעת בקשת משימה חדשה, הלקוח מספק לשרת את ה ID של המשימה האחרונה שהורצה, והשרת יבדוק האם יש משימה חדשה ורק אם כן יחזיר אחת.
נוסף על כך, הכנו ממשק המאפשר יצירה ודריסה נוחה של קובץ ה-JSON המכיל את פרטי המשימה שיש להריץ - על מנת שהמפעיל האנושי יכול לנהל את המשימות הדרושות באופן נוח.

נוסף על כך, בתוך השרת ישנו גם שרת FTP, המאפשר העלאת קבצים נוחה מהלקוחות (קבצים המכילים את הbrowser profile של הלקוח)

צד הלקוח
החל משנדבק, הלקוח אחראי בכל פרק זמן שהוגדר מראש לבקש משימה חדשה מהשרת ולהריץ אותה במידת הצורך.
גם כאן, התקשורת בין השרת ללקוח נעשית באופן מוצפן באמצעות מפתחות RSA שהוגדרו מראש.
הנוזקה יודעת לשלוח בקשות לכתובת מסוימת (IP או URL) ולזחול לתיקיות ספציפיות במחשב הקורבן ולקחת את ה-browser profiles הקיימים.

הדבקה
follina היא חולשת zero day שהייתה קיימת ב windows 10 שהייתה מאפשרת מתקפת
RCE ראשי תיבות של remote code execution על מחשב אחר דרך קובץ word. אנחנו ניצלנו את המתקפה הזו על מנת להדביק את מחשבי הקורבנות botvac
החולשה מאפשרת השתלת סקריפט בתוך קובץ ה word בצורה שאינה נראית לקורבן, והיא הלכה למעשה מדביקה אותו בחולשה.
הסקריפט יריץ ויתקין python git על מנת למשוך מה github repository את הנוזקה ויריץ סקריפט infection מסובך יותר המאפשר הרצה של הנוזקה בעת boot והשתלה נוחה של קבצי הנוזקה - כל זאת ללא התערבות המשתמש.
